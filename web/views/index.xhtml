<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Третья лаба по вебу, драсте</title>
    <!--   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>-->
    <h:outputStylesheet name="styles.css" library="css"/>
    <!--   <h:outputScript name="jquery-3.3.1.js" library="js"/>-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css" rel="stylesheet"/>
    <!--   <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet"/>-->
    <!--   <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js" type="text/javascript"></script>-->
    <h:outputScript name="script.js" library="js"/>
    <h:outputScript name="index_ready.js" library="js"/>
</h:head>

<h:body>
    <div class="main animated zoomIn fast">

        <div class="rect headerRect">
            <div class="headerText name">Венщиков Марат, P3201</div>
            <div class="headerText variant"> Вариант 20115</div>
            <h:form>
                <h:commandButton styleClass="btn backBtn" value="Back" action="success"/>
            </h:form>
        </div>

        <div class="rect">
            <div class="image">
                <svg fill="none" height="300" viewBox="0 0 200 200" width="300" id="imageSvg">
                    <rect height="200" transform="translate(0 1)" width="200"/>
                    <h:outputText value="#{AreaUtils.rect}" escape="false"/>
                    <h:outputText value="#{AreaUtils.poly}" escape="false"/>
                    <h:outputText value="#{AreaUtils.arc}" escape="false"/>
                    <text class="imageText" x="190" y="115">X</text>
                    <text class="imageText" x="105" y="10">Y</text>
                    <text id="x1" class="imageText" x="0" y="93">-R</text>
                    <text id="x2" class="imageText" x="0" y="93">-R/2</text>
                    <text id="x3" class="imageText" x="0" y="93">R/2</text>
                    <text id="x4" class="imageText" x="0" y="93">R</text>
                    <text id="y1" class="imageText" x="110" y="30">R</text>
                    <text id="y2" class="imageText" x="110" y="93">R/2</text>
                    <text id="y3" class="imageText" x="110" y="93">-R/2</text>
                    <text id="y4" class="imageText" x="110" y="93">-R</text>
                    <line id="line_y2" x1="95" x2="105" y1="65" y2="65" style="stroke:#000000;stroke-width:0.84002185"/>
                    <line id="line_x3" x1="135" x2="135" y1="95" y2="105"
                          style="stroke:#000000;stroke-width:0.84723842"/>
                    <line id="line_x2" x1="65" x2="65" y1="95" y2="105" style="stroke:#000000;stroke-width:0.84723818"/>
                    <line id="line_x4" x1="170" x2="170" y1="95" y2="105"
                          style="stroke:#000000;stroke-width:0.84515423"/>
                    <line id="line_y1" x1="95" x2="105" y1="30" y2="30" style="stroke:#000000;stroke-width:0.84002179"/>
                    <line id="line_y4" x1="95" x2="105" y1="170" y2="170"
                          style="stroke:#000000;stroke-width:0.84515423"/>
                    <line id="line_y3" x1="95" x2="105" y1="135" y2="135"
                          style="stroke:#000000;stroke-width:0.84515423"/>
                    <line id="line_x1" x1="30" x2="30" y1="95" y2="105" style="stroke:#000000;stroke-width:0.84515423"/>

                    <path d="m 199,100.35029 c 0.21516,-0.1953 0.21516,-0.511901 0,-0.707201 l -3.51097,-3.1819 c -0.21627,-0.1953 -0.56494,-0.1953 -0.7812,0 -0.21516,0.1952 -0.21516,0.5118 0,0.7071 l 3.12148,2.828402 -3.12148,2.828399 c -0.21516,0.1953 -0.21516,0.5119 0,0.7071 0.21626,0.1953 0.56493,0.1953 0.7812,0 z M 0,100.49669 H 198.6094 V 99.496689 H 0 Z"
                          id="path3818" style="fill:#000000;stroke-width:1.0504216"/>
                    <path d="m 100.3536,0.95452218 c -0.1953,-0.21550457 -0.5119,-0.21550457 -0.7072,0 L 96.4645,4.4662798 c -0.1953,0.2155078 -0.1953,0.5648873 0,0.7803952 0.1952,0.2154858 0.5118,0.2154858 0.7071,0 L 100,2.1251051 102.8284,5.246675 c 0.1953,0.2154858 0.5119,0.2154858 0.7071,0 0.1953,-0.2155079 0.1953,-0.5648874 0,-0.7803952 z M 100.5,200 V 1.3447099 h -1 V 200 Z"
                          id="path3820" style="fill:#000000;stroke-width:1.05054295"/>
                    <circle stroke="black" r="3" fill="red" id="dot" class="hide"/>
                    <g id="dotsGroup">

                    </g>
                    <g id="arrow" class="hide">
                        <path
                                id="path831"
                                d="M 0.3,0 H 20"
                                style="fill:none;fill-opacity:0.75;fill-rule:evenodd;stroke:#ff2b06;stroke-width:1.56395113;stroke-linecap:round;stroke-linejoin:round"/>
                        <path
                                id="path869"
                                d="M 4.3,-3 0.3,0 4.3,3"
                                style="fill:none;fill-rule:evenodd;stroke:#ff2b06;stroke-width:1.56395113;stroke-linecap:round;stroke-linejoin:round"/>
                    </g>
                </svg>
            </div>
        </div>
<!--        <div class="rect" id="messagesRect">-->
<!--            <h:messages id="messages" showSummary="true" showDetail="false"/>-->
<!--        </div>-->
        <div class="rect">

            <h:messages id="messages" showSummary="true" showDetail="false"/>
            <h:outputText id="debug" value="#{ResultBean.debug}"/>
            <h:form id="form" action="controller" method="GET">
                <div class="inputRow">
                    X:
                    <p:inputText
                            id="x"
                            value="#{ResultBean.x}"
                            style="width:80px"
                            required="true"
                            requiredMessage="Нужно указать значение X!"
                            validatorMessage="Недопустимое значение X!"
                            autocomplete="off"
                            onchange="checkData(this, -5, 5)"
                            onkeyup="checkData(this, -5, 5)"
                            >
                        <f:validateDoubleRange minimum="-8" maximum="8" for="x"/>
                    </p:inputText>

                    <p:slider
                            for="x"
                            minValue="-5"
                            maxValue="5"
                            step="1"
                            styleClass="slider"
                            />
                </div>
                <div class="inputRow">
                    Y:
                    <p:inputText
                            id="y"
                            value="#{ResultBean.y}"
                            required="true"
                            autocomplete="off"
                            maxlength="6"
                            placeholder="Число -5 до 3."
                            requiredMessage="Нужно указать значение Y!"
                            validator="#{ResultBean.validateY}"
                            onchange="checkData(this, -5, 3)"
                            onkeyup="checkData(this, -5, 3)"/>
                </div>
                <div class="inputRow">
                    R:
                    <p:inputText
                            id="r"
                            value="#{ResultBean.r}"
                            type="hidden"
                            required="true"
                            requiredMessage="Нужно указать радиус! (обязательно)"
                            validatorMessage="Недопустимое значение радиуса!">
                        <f:validateLongRange minimum="1" maximum="5"/>
                    </p:inputText>
                    <h:commandLink styleClass="inputButton" value="1"/>
                    <h:commandLink styleClass="inputButton" value="2"/>
                    <h:commandLink styleClass="inputButton" value="3"/>
                    <h:commandLink styleClass="inputButton" value="4"/>
                    <h:commandLink styleClass="inputButton" value="5"/>
                </div>
<!--                <h:panelGroup id="messages">-->
<!--                <h:message id="xMes" for="x" showSummary="true" showDetail="false"/><br/>-->
<!--                <h:message id="yMes" for="y" showSummary="true" showDetail="false"/><br/>-->
<!--                <h:message id="rMes" for="r" showSummary="true" showDetail="false"/>-->
<!--                </h:panelGroup>-->
                <div id="submitRow">
                    <h:commandButton
                            id="submitBtn"
                            type="submit"
                            action="#{ResultBean.save}"
                            update="form messages"
                            value="Проверить вхождение">
                        <f:ajax execute="@form" render="form historyTable debug messages histEmpty" onevent="onSend"/>
                    </h:commandButton>
                    <p:graphicImage id="loading" styleClass="hide loading" library="images" name="load.gif" style="height: 30px; margin-left: 10px;"/>
                    <h:outputScript rendered="#{facesContext.validationFailed}">
                        onError();
                    </h:outputScript>
                    <h:outputScript rendered="#{!facesContext.validationFailed}">
                        document.getElementById('form:x').setAttribute("value", "");
                        document.getElementById('form:y').setAttribute("value", "");
                    </h:outputScript>
                    <h:panelGroup rendered="#{ResultBean.match and !facesContext.validationFailed}">
                        <span class="hide alert" id="matchMessage" style="color:#008000;">Попадание!</span>
                    </h:panelGroup>
                    <h:panelGroup rendered="#{!ResultBean.match and !facesContext.validationFailed}">
                        <span class="hide alert" id="matchMessage" style="color:#B22222;">Промах!</span>
                    </h:panelGroup>
                </div>
            </h:form>
        </div>

        <div class="rect" id="historyRect">
            <button type="button" class="btn extendBtn" id="histBtn"
                    onclick="histBtnPressed();">История
            </button>
            <span class="hide alert" id="histMessage">История пуста.</span>
            <div id="histWrap">
                <div id="historyTableWrap">
                    <h:dataTable
                            id = "historyTable"
                            style="text-align: center; width: 100%;"
                            value="#{Collection.points}"
                            var="point">
                        <h:column>
                            <f:facet name="header">X</f:facet>
                            <h:outputText value='#{point.x}' />
                        </h:column>
                        <h:column>
                            <f:facet name="header">Y</f:facet>
                            <h:outputText value='#{point.y}' />
                        </h:column>
                        <h:column>
                            <f:facet name="header">R</f:facet>
                            <h:outputText value='#{point.r}' />
                        </h:column>
                        <h:column>
                            <f:facet name="header">Результат</f:facet>
                            <h:panelGroup rendered="#{point.match}">
                                <span id="yes" style="color:#008000;">Попадание</span>
                            </h:panelGroup>
                            <h:panelGroup rendered="#{!point.match}">
                                <span id="no" style="color:#B22222;">Промах</span>
                            </h:panelGroup>
                        </h:column>
                    </h:dataTable>
                    <h:panelGroup id="histEmpty">
                        <div style="text-align: center">
                            <h:outputText  value="История пуста" rendered="#{empty Collection.points}"/>
                        </div>
                    </h:panelGroup>
                </div>
            </div>
        </div>

        <div class="hide" id="history">
            <!--   <%=history.toString()%>-->
        </div>
    </div>
</h:body>
</html>
